<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Interop with C++ View Model -- GPU Accelerated C++ User Interface (vczh)</title>
<link rel="shortcut icon" href="../../favicon.ico">
<link rel="stylesheet" type="text/css" href="../../global.css">
<link rel="stylesheet" type="text/css" href="../../article.css">
<script src="../../scripts/rootView.js"></script>
<script src="../../scripts/directoryView.js"></script>
<script src="../../scripts/articleView.js"></script>

</head>
<body>
<div id="MVC-ViewContainer"></div>
<script lang="javascript">
{
  const mvcModel = {
  "path": [
    "gacui",
    "advanced",
    "vm"
  ]
};
  const mvcViews = [
  {
    "targetObject": "MVC-ViewContainer",
    "viewName": "Gaclib-RootView"
  },
  {
    "targetObject": "rootViewContainer",
    "viewName": "Gaclib-DirectoryView"
  },
  {
    "targetObject": "directoryViewContainer",
    "viewName": "Gaclib-ArticleView"
  }
];
  const hrefPrefix = "/doc/current";
  const directoryInfo = {
  "subNodes": [
    {
      "icon": "-",
      "name": "GacUI",
      "selected": false,
      "path": [
        "gacui",
        "home"
      ],
      "subNodes": [
        {
          "icon": "-",
          "name": "Advanced Topics",
          "selected": false,
          "path": [
            "gacui",
            "advanced",
            "home"
          ],
          "subNodes": [
            {
              "icon": " ",
              "name": "Interop with C++ View Model",
              "selected": true,
              "path": [
                "gacui",
                "advanced",
                "vm"
              ]
            },
            {
              "icon": " ",
              "name": "Data Bindings",
              "selected": false,
              "path": [
                "gacui",
                "advanced",
                "bindings"
              ]
            },
            {
              "icon": " ",
              "name": "Animations",
              "selected": false,
              "path": [
                "gacui",
                "advanced",
                "animations"
              ]
            },
            {
              "icon": " ",
              "name": "Localization",
              "selected": false,
              "path": [
                "gacui",
                "advanced",
                "localization"
              ]
            },
            {
              "icon": " ",
              "name": "Cross XML Resource References",
              "selected": false,
              "path": [
                "gacui",
                "advanced",
                "cxrr"
              ]
            },
            {
              "icon": " ",
              "name": "ALT Sequence and Control Focus",
              "selected": false,
              "path": [
                "gacui",
                "advanced",
                "alt"
              ]
            },
            {
              "icon": " ",
              "name": "TAB and Control Focus",
              "selected": false,
              "path": [
                "gacui",
                "advanced",
                "tab"
              ]
            },
            {
              "icon": " ",
              "name": "Creating New List Controls",
              "selected": false,
              "path": [
                "gacui",
                "advanced",
                "impllistcontrol"
              ]
            },
            {
              "icon": " ",
              "name": "Porting GacUI to Other Platforms",
              "selected": false,
              "path": [
                "gacui",
                "advanced",
                "implosprovider"
              ]
            }
          ]
        }
      ]
    }
  ]
};
  const article = {
  "index": true,
  "numberBeforeTitle": false,
  "topic": {
    "kind": "Topic",
    "title": "Interop with C++ View Model",
    "content": [
      {
        "kind": "Paragraph",
        "content": [
          {
            "kind": "Text",
            "text": "\n            It is recommended to use the\n            "
          },
          {
            "kind": "PageLink",
            "href": "https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93viewmodel",
            "content": [
              {
                "kind": "Text",
                "text": "MVVM"
              }
            ]
          },
          {
            "kind": "Text",
            "text": "\n            pattern with GacUI:\n            "
          },
          {
            "kind": "List",
            "ordered": false,
            "items": [
              {
                "kind": "ParagraphListItem",
                "paragraphs": [
                  {
                    "kind": "Paragraph",
                    "content": [
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Model"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": ":\n                        It refers to a domain model.\n                        Code in "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Model"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " solves real problem that users need.\n                        It could be an object-oriented design of a domain,\n                        it could also be a data access layer to the data in database, from the internet, or any possible way.\n                    "
                      }
                    ]
                  }
                ]
              },
              {
                "kind": "ParagraphListItem",
                "paragraphs": [
                  {
                    "kind": "Paragraph",
                    "content": [
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "ViewModel"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": ":\n                        It refers to a set of interface exposing the "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Model"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " in a convient way for "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Views"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": ".\n                        Data organization in "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Model"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " doesn't have to be UI friendly.\n                        It is the "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "ViewModel"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " who exposes a right set of operations,\n                        to make "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Views"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " access "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Model"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " convenient.\n                    "
                      }
                    ]
                  },
                  {
                    "kind": "Paragraph",
                    "content": [
                      {
                        "kind": "Text",
                        "text": "\n                        For example,\n                        there are many applications offer list sorting to users.\n                        Data in "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Model"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " is not sorted,\n                        it could be indexed,\n                        because there is so many way to sort the data,\n                        it is a waste of storage to cache all sorting result.\n                        When a user sort the data in a specific way,\n                        it is the "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "ViewModel"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " who handels the sorting.\n                        the "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "ViewModel"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " accesses the data,\n                        return the data organization in a sorted way.\n                    "
                      }
                    ]
                  }
                ]
              },
              {
                "kind": "ParagraphListItem",
                "paragraphs": [
                  {
                    "kind": "Paragraph",
                    "content": [
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "View"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": ":\n                        A "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "View"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " could be the actual UI of an application,\n                        it could also be a set of unit tests.\n                        "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Views"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": " access "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "ViewModel"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": ",\n                        typically it doesn't access "
                      },
                      {
                        "kind": "Strong",
                        "content": [
                          {
                            "kind": "Text",
                            "text": "Model"
                          }
                        ]
                      },
                      {
                        "kind": "Text",
                        "text": ".\n                    "
                      }
                    ]
                  }
                ]
              }
            ]
          }
        ]
      },
      {
        "kind": "Paragraph",
        "content": [
          {
            "kind": "Text",
            "text": "\n            In GacUI,\n            "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "ViewModels"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " are defined as a set of interfaces in\n            "
          },
          {
            "kind": "PageLink",
            "href": "/gacui/xmlres/tag_script.html",
            "content": [
              {
                "kind": "Text",
                "text": "Workflow script files"
              }
            ]
          },
          {
            "kind": "Text",
            "text": ".\n            "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "Views"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " are defined as a set of\n            "
          },
          {
            "kind": "PageLink",
            "href": "/gacui/xmlres/instance/root_instance.html",
            "content": [
              {
                "kind": "Text",
                "text": "windows and controls"
              }
            ]
          },
          {
            "kind": "Text",
            "text": ".\n        "
          }
        ]
      },
      {
        "kind": "Paragraph",
        "content": [
          {
            "kind": "Text",
            "text": "\n            All "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "ViewModels"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " that are needed in a "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "View"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " are defined as\n            "
          },
          {
            "kind": "PageLink",
            "href": "/gacui/xmlres/tag_instance.html",
            "content": [
              {
                "kind": "Strong",
                "content": [
                  {
                    "kind": "Text",
                    "text": "<ref.Parameter/>"
                  }
                ]
              }
            ]
          },
          {
            "kind": "Text",
            "text": ",\n            which represents constructor arguments to that "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "View"
              }
            ]
          },
          {
            "kind": "Text",
            "text": ".\n            The "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "Class"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " attributes of such "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "<ref.Parameter/>"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " will be interfaces for "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "ViewModels"
              }
            ]
          },
          {
            "kind": "Text",
            "text": ".\n        "
          }
        ]
      },
      {
        "kind": "Paragraph",
        "content": [
          {
            "kind": "Text",
            "text": "\n            In the GacUI entry point (the "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "GuiMain"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " function),\n            a main window will be created.\n            If the main window needs "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "ViewModels"
              }
            ]
          },
          {
            "kind": "Text",
            "text": ",\n            the main window "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "<Instance/>"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " will have one or more "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "<ref.Parameter/>"
              }
            ]
          },
          {
            "kind": "Text",
            "text": ",\n            then the constructor of the main window will have one or more constructor arguments.\n        "
          }
        ]
      },
      {
        "kind": "Paragraph",
        "content": [
          {
            "kind": "Text",
            "text": "\n            Now, "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "GuiMain"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " just needs to create classes that implement these interfaces,\n            and gives all of them to the constructor of the main window,\n            then "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "ViewModels"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " and the "
          },
          {
            "kind": "Strong",
            "content": [
              {
                "kind": "Text",
                "text": "View"
              }
            ]
          },
          {
            "kind": "Text",
            "text": " is connected together.\n        "
          }
        ]
      },
      {
        "kind": "Topic",
        "title": "Sample",
        "content": [
          {
            "kind": "Paragraph",
            "content": [
              {
                "kind": "PageLink",
                "href": "https://github.com/vczh-libraries/Release/tree/master/Tutorial/GacUI_HelloWorlds/MVVM",
                "content": [
                  {
                    "kind": "Text",
                    "text": "This"
                  }
                ]
              },
              {
                "kind": "Text",
                "text": "\n                is a very simple example for using MVVM in GacUI.\n            "
              }
            ]
          },
          {
            "kind": "Paragraph",
            "content": [
              {
                "kind": "Image",
                "src": "/gacui/adv_mvvm.gif"
              }
            ]
          },
          {
            "kind": "Paragraph",
            "content": [
              {
                "kind": "Text",
                "text": "\n                The "
              },
              {
                "kind": "Strong",
                "content": [
                  {
                    "kind": "Text",
                    "text": "ViewModel"
                  }
                ]
              },
              {
                "kind": "Text",
                "text": " is an interface:\n                "
              },
              {
                "kind": "Program",
                "code": "interface IViewModel\r\n{\r\n    func GetUserName() : string;\r\n    func SetUserName(value : string) : void;\r\n    prop UserName : string {GetUserName, SetUserName}\r\n        \r\n    func GetPassword() : string;\r\n    func SetPassword(value : string) : void;\r\n    prop Password : string {GetPassword, SetPassword}\r\n        \r\n    func GetUserNameError() : string;\r\n    event UserNameErrorChanged();\r\n    prop UserNameError : string {GetUserNameError : UserNameErrorChanged}\r\n        \r\n    func GetPasswordError() : string;\r\n    event PasswordErrorChanged();\r\n    prop PasswordError : string {GetPasswordError : PasswordErrorChanged}\r\n        \r\n    func SignUp() : bool;\r\n}"
              },
              {
                "kind": "Text",
                "text": "\n                It defines all "
              },
              {
                "kind": "Strong",
                "content": [
                  {
                    "kind": "Text",
                    "text": "View"
                  }
                ]
              },
              {
                "kind": "Text",
                "text": " needs to know:\n                "
              },
              {
                "kind": "List",
                "ordered": false,
                "items": [
                  {
                    "kind": "ContentListItem",
                    "content": [
                      {
                        "kind": "Text",
                        "text": "Accessing the user name and the password."
                      }
                    ]
                  },
                  {
                    "kind": "ContentListItem",
                    "content": [
                      {
                        "kind": "Text",
                        "text": "Retriving validation results for the user name and the password."
                      }
                    ]
                  }
                ]
              }
            ]
          },
          {
            "kind": "Paragraph",
            "content": [
              {
                "kind": "Text",
                "text": "\n                When the content of a text box is changed,\n                the data is stored to the view model.\n                This is implemented using data bindings to the view model object:\n                "
              },
              {
                "kind": "Program",
                "code": "<ref.Parameter Name=\"ViewModel\" Class=\"vm::IViewModel\"/>\r\n<Window ref.Name=\"self\" Text=\"Let's Sign Up!\" ClientSize=\"x:320 y:320\">\r\n    <att.ViewModel-set UserName-bind=\"textBoxUserName.Text\" Password-bind=\"textBoxPassword.Text\"/>\r\n    ..."
              }
            ]
          },
          {
            "kind": "Paragraph",
            "content": [
              {
                "kind": "Text",
                "text": "\n                When the validation result is changed,\n                errors are displayed to the UI immediately.\n                This is implemented using data bindings to UI objects:\n                "
              },
              {
                "kind": "Program",
                "code": "<SolidLabel Text-bind=\"ViewModel.UserNameError\"/>"
              }
            ]
          },
          {
            "kind": "Paragraph",
            "content": [
              {
                "kind": "Text",
                "text": "\n                When the user name or the password is stored to the view model,\n                validation results are updated automatically.\n                This is implemented in a C++ class which inherits the interface:\n                "
              },
              {
                "kind": "Program",
                "code": "class ViewModel : public Object, public virtual vm::IViewModel\r\n{\r\nprivate:\r\n    WString userName;\r\n    WString password;\r\n    Regex regexLcLetters;\r\n    Regex regexUcLetters;\r\n    Regex regexNumbers;\r\n\r\npublic:\r\n    ViewModel()\r\n        :regexLcLetters(L\"[a-z]\")\r\n        , regexUcLetters(L\"[A-Z]\")\r\n        , regexNumbers(L\"[0-9]\")\r\n    {\r\n    }\r\n\r\n    ...\r\n\r\n    WString GetPassword()override\r\n    {\r\n        return password;\r\n    }\r\n\r\n    void SetPassword(const WString& value)override\r\n    {\r\n        password = value;\r\n        PasswordErrorChanged();\r\n    }\r\n\r\n    WString GetPasswordError()override\r\n    {\r\n        if (password == L\"\")\r\n        {\r\n            return L\"Password should not be empty.\";\r\n        }\r\n        bool containsLowerCases = regexLcLetters.Match(password);\r\n        bool containsUpperCases = regexUcLetters.Match(password);\r\n        bool containsNumbers = regexNumbers.Match(password);\r\n        if (!containsLowerCases || !containsUpperCases || !containsNumbers)\r\n        {\r\n            return L\"Password should contains at least one lower case letter, one upper case letter and one digit.\";\r\n        }\r\n        return L\"\";\r\n    }\r\n};"
              }
            ]
          },
          {
            "kind": "Paragraph",
            "content": [
              {
                "kind": "Text",
                "text": "\n                It is very easy to connect the "
              },
              {
                "kind": "Strong",
                "content": [
                  {
                    "kind": "Text",
                    "text": "ViewModel"
                  }
                ]
              },
              {
                "kind": "Text",
                "text": " to the "
              },
              {
                "kind": "Strong",
                "content": [
                  {
                    "kind": "Text",
                    "text": "View"
                  }
                ]
              },
              {
                "kind": "Text",
                "text": ":\n                "
              },
              {
                "kind": "Program",
                "code": "void GuiMain()\r\n{\r\n    ...\r\n    auto viewModel = MakePtr<ViewModel>();\r\n    auto window = new helloworld::MainWindow(viewModel);\r\n    ...\r\n}"
              }
            ]
          },
          {
            "kind": "Paragraph",
            "content": [
              {
                "kind": "Text",
                "text": "\n                Collection objects or tree-like objects can be binded to\n                "
              },
              {
                "kind": "PageLink",
                "href": "/gacui/components/controls/list/home.html",
                "content": [
                  {
                    "kind": "Text",
                    "text": "list controls"
                  }
                ]
              },
              {
                "kind": "Text",
                "text": "\n                directly.\n                Data bindings accept any\n                "
              },
              {
                "kind": "PageLink",
                "href": "/workflow/lang/bind.html",
                "content": [
                  {
                    "kind": "Text",
                    "text": "workflow expressions"
                  }
                ]
              },
              {
                "kind": "Text",
                "text": "\n                that compiles.\n                MVVM in GacUI is very powerful,\n                you are free to choose any way to define "
              },
              {
                "kind": "Strong",
                "content": [
                  {
                    "kind": "Text",
                    "text": "ViewModel"
                  }
                ]
              },
              {
                "kind": "Text",
                "text": " interfaces,\n                and it is always possible to bind it to the UI.\n            "
              }
            ]
          }
        ]
      }
    ]
  }
};
  window["MVC-Resources.mvcModel"] = mvcModel;
  window["MVC-Resources.mvcViews"] = mvcViews;
  window["MVC-Resources.hrefPrefix"] = hrefPrefix;
  window["MVC-Resources.directoryInfo"] = directoryInfo;
  window["MVC-Resources.article"] = article;
  for (const view of mvcViews) {
    window[view.viewName].renderView(mvcModel, document.getElementById(view.targetObject));
  }
  const renderedScriptTags = document.getElementById("MVC-ViewContainer").getElementsByTagName("script");
  for (const scriptTag of renderedScriptTags) {
    eval(
      "(function(){" + scriptTag.innerHTML + "})()"
    );
  }
}
</script>
</body>
</html>
